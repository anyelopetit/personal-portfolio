var extrasEditor={buildHtml:function(e){for(var t="",a=["keppler-header","keppler-view","keppler-footer"],i=0;i<e.length;i++)if(a.includes(e[i].localName)){for(var n=this.getNoEditIdsEditor(e[i]),s=0;s<n.length;s++)$(e[i]).find("#"+n[s]).replaceWith(function(){return $("<keppler-no-edit/>",{id:n[s],html:this.innerHTML})});t+=processHtml(e[i].outerHTML)}return t},getNoEditIdsEditor:function(e){for(var t=e.querySelectorAll(".no-edit-area"),a=[],i=0;i<t.length;i++)a.push(t[i].id);return a},getNoEditIds:function(){for(var e=document.querySelectorAll(".no-edit-area"),t=[],a=0;a<e.length;a++)t.push(e[a].id);return t},createNoEditAreaEditor:function(){$("keppler-no-edit").addClass("no-edit-area"),noEditIds=this.getNoEditIds(),$("keppler-no-edit").replaceWith(function(){return $("<div/>",{"class":"no-edit-area",html:this.innerHTML})});for(var e=document.querySelectorAll(".no-edit-area"),t=0;t<e.length;t++)e[t].id=noEditIds[t]},getIfNotArea:function(e){for(var t=["keppler-header","keppler-view","keppler-footer"],a=!1,i=0;i<e.path.length;i++){var n=$(e.path[i])[0].id;t.includes(n)&&(a=!0)}return a},createAreas:function(){for(var e=["keppler-header","keppler-view","keppler-footer"],t=0;t<e.length;t++)$(e[t]).replaceWith(function(){return $("<div/>",{id:e[t],html:this.innerHTML})})},deleteAreas:function(e,t){e=$(e);for(var a=["keppler-header","keppler-view","keppler-footer"],i=[],n=0;n<e.length;n++)if(a.includes(e[n].id)){var s=document.createElement(e[n].id);s.innerHTML=e[n].innerHTML,"keppler-view"===e[n].id&&(s.id=t),i.push(s)}return i}};$(document).ready(function(){function saveCode(){try{var e=extrasEditor.deleteAreas(editor.getHtml(),view_name),t=(e=extrasEditor.buildHtml(e),editor.getCss());t=cssbeautify(t,{indent:" ",openbrace:"separate-line",autosemicolon:!0});$.post("/admin/frontend/views/"+view_id+"/live_editor/save",{html:e,css:t},function(e){alert(e.result)})}catch(a){alert("Error when saving: Check that all is well")}}for(var blkStyle='.blk-row::after{ content: ""; clear: both; display: block;} .blk-row{padding: 10px;}',sectors=[{name:"General",open:!1,buildProps:["float","display","z-index","position","top","right","left","bottom"],properties:[{id:"z-index",type:"integer",name:"Position index",property:"z-index",defaults:0},{type:"select",property:"list-style-type","default":"none",list:[{value:"none",name:"None"},{value:"circle",name:"Circle"},{value:"disc",name:"Disc"},{value:"square",name:"Square"},{value:"decimal",name:"Decimal"},{value:"decimal-leading-zero ",name:"Decimal leading zero "},{value:"lower-alpha",name:"Lower alpha"},{value:"upper-alpha",name:"Upper alpha"},{value:"lower-greek",name:"Lower greek"},{value:"lower-latin",name:"Lower latin"},{value:"upper-latin",name:"Upper latin"},{value:"lower-roman",name:"Lower roman"},{value:"upper-roman",name:"Upper roman"},{value:"armenian",name:"Armenian"},{value:"georgian",name:"Georgian"},{value:"cjk-ideographic",name:"Cjk ideographic"},{value:"hiragana",name:"Hiragana"},{value:"katakana",name:"Katakana"},{value:"hiragana-iroha",name:"Hiragana iroha"},{value:"katakana-iroha",name:"Katakana iroha"}]},{property:"list-style-position",type:"radio",list:[{value:"inside",name:"Inside"},{value:"outside",name:"Outside"}]},{property:"cursor",type:"select",defaults:"auto",list:[{value:"auto",name:"Auto"},{value:"crosshair",name:"Crosshair"},{value:"default",name:"Default"},{value:"help",name:"Help"},{value:"move",name:"Move"},{value:"progress",name:"Progress"},{value:"pointer",name:"Pointer"},{value:"n-resize",name:"N-resize"},{value:"ne-resize ",name:"Ne-resize "},{value:"e-resize",name:"E-resize"},{value:"se-resize",name:"Se-resize"},{value:"s-resize",name:"S-resize"},{value:"sw-resize",name:"Sw-resize"},{value:"w-resize",name:"W-resize"},{value:"nw-resize",name:"Nw-resize"},{value:"text",name:"Text"},{value:"wait",name:"Wait"}]},{property:"overflow",type:"select",defaults:"auto",list:[{value:"auto",name:"Auto"},{value:"hidden",name:"Hidden"},{value:"visible",name:"Visible"},{value:"scroll",name:"Scroll"},{value:"initial",name:"Initial"},{value:"inherit",name:"Inherit"}]},{property:"overflow-x",type:"select",defaults:"auto",list:[{value:"auto",name:"Auto"},{value:"hidden",name:"Hidden"},{value:"visible",name:"Visible"},{value:"scroll",name:"Scroll"},{value:"initial",name:"Initial"},{value:"inherit",name:"Inherit"}]},{property:"overflow-y",type:"select",defaults:"auto",list:[{value:"auto",name:"Auto"},{value:"hidden",name:"Hidden"},{value:"visible",name:"Visible"},{value:"scroll",name:"Scroll"},{value:"initial",name:"Initial"},{value:"inherit",name:"Inherit"}]}]},{name:"Dimension",open:!1,buildProps:["width","flex-width","height","min-width","max-width","min-height","max-height","padding","margin"],properties:[{id:"flex-width",type:"integer",name:"Width",units:["px","%","rem","em"],property:"flex-basis",toRequire:1},{id:"width",type:"integer",name:"Width",units:["px","%","rem","em"],property:"width"},{id:"height",type:"integer",name:"Height",units:["px","%","rem","em"],property:"height"},{id:"min-width",type:"integer",name:"Min width",units:["px","%","rem","em"],property:"min-width"},{id:"max-width",type:"integer",name:"Max width",units:["px","%","rem","em"],property:"max-width"},{id:"min-height",type:"integer",name:"Min height",units:["px","%","rem","em"],property:"min-height"},{id:"max-height",type:"integer",name:"Max height",units:["px","%","rem","em"],property:"max-height"},{name:"Padding",property:"padding",type:"composite",properties:[{id:"padding-top",type:"integer",name:"Top",units:["px","%","rem","em"],property:"padding-top",defaults:0},{id:"padding-right",type:"integer",name:"Right",units:["px","%","rem","em"],property:"padding-right",defaults:0},{id:"padding-left",type:"integer",name:"Left",units:["px","%","rem","em"],property:"padding-left",defaults:0},{id:"padding-bottom",type:"integer",name:"Bottom",units:["px","%","rem","em"],property:"padding-bottom",defaults:0}]},{name:"Margin",property:"margin",type:"composite",properties:[{id:"margin-top",type:"integer",name:"Top",units:["px","%","rem","em"],property:"margin-top",defaults:0},{id:"margin-right",type:"integer",name:"Right",units:["px","%","rem","em"],property:"margin-right",defaults:0},{id:"margin-left",type:"integer",name:"Left",units:["px","%","rem","em"],property:"margin-left",defaults:0},{id:"margin-bottom",type:"integer",name:"Bottom",units:["px","%","rem","em"],property:"margin-bottom",defaults:0}]}]},{name:"Typography",open:!1,buildProps:["font-family","font-size","font-weight","letter-spacing","color","line-height","text-indent","font-style","text-align","text-transform","text-decoration","text-shadow"],properties:[{property:"text-align",list:[{value:"left",className:"fa fa-align-left"},{value:"center",className:"fa fa-align-center"},{value:"right",className:"fa fa-align-right"},{value:"justify",className:"fa fa-align-justify"}]},{id:"text-indent",type:"integer",name:"Text indent",units:["px","%","rem","em"],property:"text-indent",defaults:0},{property:"font-style",type:"radio",list:[{value:"normal",name:"Normal"},{value:"italic",name:"Italic"},{value:"oblique",name:"Oblique"}]},{property:"text-transform",type:"radio",list:[{value:"lowercase",name:"a"},{value:"uppercase",name:"A"},{value:"capitalize",name:"Aa"}]},{property:"text-decoration",type:"radio",list:[{value:"underline",className:"fa fa-underline"},{value:"line-through",className:"fa fa-strikethrough"}]},{property:"font-family",type:"text"}]},{name:"Decorations",open:!1,buildProps:["border-radius-c","background-color","border-radius","border","box-shadow","background"]},{name:"Extra",open:!1,buildProps:["opacity","filter","transition","perspective","transform"],properties:[{type:"slider",property:"opacity",defaults:1,step:.01,max:1,min:0}]},{name:"Flex",open:!1,properties:[{name:"Flex Container",property:"display",type:"select",defaults:"block",list:[{value:"block",name:"Disable"},{value:"flex",name:"Enable"}]},{name:"Flex Parent",property:"label-parent-flex"},{name:"Direction",property:"flex-direction",type:"radio",defaults:"row",list:[{value:"row",name:"Row",className:"icons-flex icon-dir-row",title:"Row"},{value:"row-reverse",name:"Row reverse",className:"icons-flex icon-dir-row-rev",title:"Row reverse"},{value:"column",name:"Column",title:"Column",className:"icons-flex icon-dir-col"},{value:"column-reverse",name:"Column reverse",title:"Column reverse",className:"icons-flex icon-dir-col-rev"}]},{name:"Wrap",property:"flex-wrap",type:"radio",defaults:"nowrap",list:[{value:"nowrap",title:"Single line"},{value:"wrap",title:"Multiple lines"},{value:"wrap-reverse",title:"Multiple lines reverse"}]},{name:"Justify",property:"justify-content",type:"radio",defaults:"flex-start",list:[{value:"flex-start",className:"icons-flex icon-just-start",title:"Start"},{value:"flex-end",title:"End",className:"icons-flex icon-just-end"},{value:"space-between",title:"Space between",className:"icons-flex icon-just-sp-bet"},{value:"space-around",title:"Space around",className:"icons-flex icon-just-sp-ar"},{value:"center",title:"Center",className:"icons-flex icon-just-sp-cent"}]},{name:"Align",property:"align-items",type:"radio",defaults:"center",list:[{value:"flex-start",title:"Start",className:"icons-flex icon-al-start"},{value:"flex-end",title:"End",className:"icons-flex icon-al-end"},{value:"stretch",title:"Stretch",className:"icons-flex icon-al-str"},{value:"center",title:"Center",className:"icons-flex icon-al-center"}]},{name:"Flex Children",property:"label-parent-flex"},{name:"Order",property:"order",type:"integer",defaults:0,min:0},{name:"Flex",property:"flex",type:"composite",properties:[{name:"Grow",property:"flex-grow",type:"integer",defaults:0,min:0},{name:"Shrink",property:"flex-shrink",type:"integer",defaults:0,min:0},{name:"Basis",property:"flex-basis",type:"integer",units:["px","%",""],unit:"",defaults:"auto"}]},{name:"Align",property:"align-self",type:"radio",defaults:"auto",list:[{value:"auto",name:"Auto"},{value:"flex-start",title:"Start",label:"Start",className:"icons-flex icon-al-start"},{value:"flex-end",title:"End",className:"icons-flex icon-al-end"},{value:"stretch",title:"Stretch",className:"icons-flex icon-al-str"},{value:"center",title:"Center",className:"icons-flex icon-al-center"}]}]}],links=document.getElementsByTagName("link"),styles=[],i=1;i<links.length;i++)styles.push(links[i].href);for(var links=document.getElementsByTagName("script"),scripts=[],i=0;i<links.length;i++)scripts.push(links[i].src);try{var css_style=gon.css_style,images_assets=gon.images_assets,view_id=gon.view_id,view_name=gon.view_name}catch(e){e instanceof SyntaxError&&console.log(e.message)}var editor=grapesjs.init({container:"#keppler-editor",protectedCss:"",style:css_style,scripts:"function abr(){}",canvas:{styles:styles,scripts:scripts},width:"auto",fromElement:!0,plugins:["testplug","gjs-blocks-basic","grapesjs-custom-code","gjs-plugin-forms","grapesjs-lory-slider","gjs-component-countdown","gjs-style-gradient"],pluginsOpts:{"gjs-style-gradient":{colorPicker:"default",grapickOpts:{min:1,max:99}}},autorender:0,allowScripts:1,showOffsets:1,noticeOnUnload:0,avoidInlineStyle:1,avoidDefaults:1,storageManager:{autoload:0},layerManager:{showWrapper:0},assetManager:{upload:"/admin/frontend/assets/upload",autoAdd:!0,assets:images_assets},styleManager:{clearProperties:1,sectors:sectors}});window.editor=editor;var toogleTools=!1,pnm=editor.Panels;pnm.addButton("commands",[{id:"keppler-logo",className:"gjs-keppler-logo",command:function(){}}]),pnm.addButton("options",[{id:"undo",className:"fa fa-undo icon-undo",title:"Undo",command:function(e){return e.runCommand("core:undo")}},{id:"redo",title:"Redo",className:"fa fa-repeat icon-redo",command:function(e){return e.runCommand("core:redo")}},{id:"refresh",title:"Refresh",className:"fa fa-refresh",command(e,t){window.location.reload()}},{id:"save-code",title:"Save",className:"fa fa-save",command(e,t){saveCode(e,view_id)}},{id:"exit",title:"Exit",className:"fa fa-sign-out",command(e,t){if(!0===confirm("Are you sure?")){var a="/admin/frontend/views/"+view_id+"/editor";window.location.href=a}}},{id:"show-tools",title:"Open tools",className:"fa fa-bars",command(e,t){!1===toogleTools?($(".gjs-pn-views").removeClass("gsj-hide-tools").addClass("gsj-show-tools"),$(".gjs-pn-views-container").removeClass("gsj-hide-tools").addClass("gsj-show-tools"),$(".gjs-pn-options > .gjs-pn-buttons > .gjs-pn-btn.fa-bars ").removeClass("fa-bars").addClass("fa-times"),toogleTools=!0):($(".gjs-pn-views").removeClass("gsj-show-tools").addClass("gsj-hide-tools"),$(".gjs-pn-views-container").removeClass("gsj-show-tools").addClass("gsj-hide-tools"),$(".gjs-pn-options > .gjs-pn-buttons > .gjs-pn-btn.fa-times ").removeClass("fa-times").addClass("fa-bars"),toogleTools=!1)}}]),editor.StyleManager.addProperty("Decorations",{id:"gradient",name:"Gradient",property:"background-image",type:"gradient",defaults:"none"});var codeButton=pnm.getButton("options","fullscreen");codeButton.collection.remove(codeButton);var bm=editor.BlockManager,noArea=!1;editor.on("canvas:dragenter",()=>{$(".gjs-pn-views").removeClass("gsj-show-tools").addClass("gsj-hide-tools"),$(".gjs-pn-views-container").removeClass("gsj-show-tools").addClass("gsj-hide-tools"),$(".gjs-pn-options > .gjs-pn-buttons > .gjs-pn-btn.fa-bars ").removeClass("fa-times").addClass("fa-bars")}),editor.on("canvas:dragend",e=>{noArea=extrasEditor.getIfNotArea(e),$(".gjs-pn-views").removeClass("gsj-hide-tools").addClass("gsj-show-tools"),$(".gjs-pn-views-container").removeClass("gsj-hide-tools").addClass("gsj-show-tools"),$(".gjs-pn-options > .gjs-pn-buttons > .gjs-pn-btn.fa-times ").removeClass("fa-bars").addClass("fa-times")}),editor.on("block:drag:start",()=>{for(var e=["header","view","footer"],t=0;t<e.length;t++){var a=$(".gjs-frame").contents().find("#keppler-"+e[t]);$(a).addClass("keppler-"+e[t]+"-area")}}),editor.on("block:drag:stop",e=>{for(var t=["header","view","footer"],a=0;a<t.length;a++){var i=$(".gjs-frame").contents().find("#keppler-"+t[a]);$(i).removeClass("keppler-"+t[a]+"-area")}i=$(e.view.$el[0]);noArea||i.remove()}),bm.add("link",{label:"Link",category:"Basic",attributes:{"class":"fa fa-link"},content:{type:"link",content:"Link",style:{color:"#d983a6"}}}),bm.add("link-block",{label:"Link Block",attributes:{"class":"fa fa-link"},category:"Basic",content:{type:"link",editable:!1,draggable:"#wrapper",style:{display:"inline-block",padding:"5px","min-height":"50px","min-width":"50px"}}}),bm.add("image",{label:"Image",category:"Basic",attributes:{"class":"gjs-fonts gjs-f-image"},content:{style:{color:"black"},type:"image",activeOnRender:1}}),bm.add("video",{label:"Video",category:"Basic",attributes:{"class":"fa fa-youtube-play"},content:{type:"video",src:"img/video2.webm",style:{height:"350px",width:"615px"}}}),bm.add("b1-2",{label:"Flex Columns",category:"Layouts",attributes:{"class":"gjs-fonts gjs-f-b1"},content:'\n    <div class="row-flex" data-columns="1" style="text-align: center" data-gjs-droppable="[data-column]" data-gjs-highlightable="false" data-gjs-resizable=\'{"tl":0,"tc":0,"tr":0,"cl":0,"cr":0,"bl":0,"br":0}\' data-gjs-custom-name="Row">\n      <div class="cell-flex" data-column="1" style="letter-spacing: normal; flex-basis: 100%" data-gjs-draggable="[data-columns]" data-gjs-resizable=\'{"tl":0,"tc":0,"tr":0,"cl":0,"bl":0,"br":0,"bc": 0, "keyWidth": "flex-basis", "currentUnit": 1, "minDim": 1, "maxDim": 100, "step": 0.2}\' data-gjs-unstylable=\'["width"]\' data-gjs-stylable-require=\'["flex-basis"]\'></div>\n      <div class="cell-flex" data-column="1" style="letter-spacing: normal; flex-basis: 100%" data-gjs-draggable="[data-columns]" data-gjs-resizable=\'{"tl":0,"tc":0,"tr":0,"cl":0,"bl":0,"br":0,"bc": 0, "keyWidth": "flex-basis", "currentUnit": 1, "minDim": 1, "maxDim": 100, "step": 0.2}\' data-gjs-unstylable=\'["width"]\' data-gjs-stylable-require=\'["flex-basis"]\'></div>\n    </div>\n    <style>\n      .row-flex {\n          display: flex;\n          justify-content: flex-start;\n          align-items: stretch;\n          flex-wrap: nowrap;\n          padding: 10px;\n      }\n\n      .cell-flex {\n        min-height: 75px;\n        flex-grow: 1;\n        flex-basis: 100%;\n      }\n    </style>\n    '});try{for(var i=0;i<gon.components.length;i++){var component=eval(gon.components[i][0]);2===component.length&&(component[1].content.components=gon.components[i][1],bm.add(component[0],component[1]))}}catch(e){e instanceof SyntaxError&&console.log(e.message)}bm.add("section",{id:"section",label:"Section",attributes:{"class":"fa fa-code"},category:"Layouts",content:{content:"<section>Section content</section>",style:{padding:"10px"},activeOnRender:1}}),bm.add("text",{id:"text",label:"Text",attributes:{"class":"gjs-fonts gjs-f-text"},category:"Typography",content:{type:"text",content:"Insert your text here",style:{padding:"10px"},activeOnRender:1}}),bm.add("h1p",{label:"Text section",category:"Typography",content:'<div>\n    <h1 class="heading">Insert title here</h1>\n    <p class="paragraph">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua</p>\n    </div>',attributes:{"class":"gjs-fonts gjs-f-h1p"}}),bm.add("quo",{label:"Quote",category:"Typography",content:'<blockquote class="quote">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore ipsum dolor sit</blockquote>',attributes:{"class":"fa fa-quote-right"}}),bm.add("map",{label:"Map",category:"Extra",attributes:{"class":"fa fa-map-o"},content:{type:"map",style:{height:"350px"}}}),editor.on("storage:load",function(){}),editor.on("storage:store",function(){});var domComps=editor.DomComponents,dType=domComps.getType("default"),dModel=dType.model,dView=dType.view;domComps.addType("input",{model:dModel.extend({defaults:Object.assign({},dModel.prototype.defaults,{traits:["name","placeholder",{type:"select",label:"Type",name:"type",options:[{value:"text",name:"Text"},{value:"email",name:"Email"},{value:"password",name:"Password"},{value:"number",name:"Number"}]},{type:"checkbox",label:"Required",name:"required"}]})},{isComponent:function(e){if("INPUT"==e.tagName)return{type:"input"}}}),view:dView}),editor.on("traverse:html",function(){}),editor.on("load",()=>{}),editor.render(),editor.on("styleable:change",(e,t)=>{const a=e.getStyle()[t];a!=undefined&&-1===a.indexOf("!important")&&e.addStyle({[t]:a+" !important"})}),editor.Commands.add("set-device-desktop",{run:e=>e.setDevice("Desktop")}),editor.Commands.add("set-device-mobile",{run:e=>e.setDevice("Mobile")});var devices=editor.DeviceManager;devices.add("Desktop Extra Large (1900px)","1900px"),devices.add("Desktop Large (1600px)","1600px"),devices.add("Desktop Medium (1440px)","1440px"),devices.add("iPad Portrait (768px)","768px"),devices.add("iPad Landscape (1024px x 768px)","1024px",{height:"768px"}),devices.add("Galaxy S5 Portrait (360px x 640px)","360px",{height:"640px"}),devices.add("Galaxy S5 Landscape (640px x 360px)","640px",{height:"360px"}),devices.add("Pixel 2 Portrait (411px x 731px)","411px",{height:"731px"}),devices.add("Pixel 2 Landscape (731px x 411px)","731px",{height:"411px"}),devices.add("Pixel 2 XL Portrait (411px x 823px)","411px",{height:"823px"}),devices.add("Pixel 2 XL Landscape (823px x 411px)","823px",{height:"411px"}),devices.add("iPhone 5/SE Portrait (320px x 568px)","320px",{height:"568px"}),devices.add("iPhone 5/SE Landscape (568px x 320px)","568px",{height:"320px"}),devices.add("iPhone 6/7/8 Portrait (375px x 667px)","375px",{height:"667px"}),devices.add("iPhone 6/7/8 Landscape (667px x 375px)","667px",{height:"375px"}),devices.add("iPhone 6/7/8 Plus Portrait (414px x 736px)","414px",{height:"736px"}),devices.add("iPhone 6/7/8 Plus Landscape (736px x 414px)","736px",{height:"414px"}),devices.add("iPhone X Portrait (375px x 812px)","375px"),devices.add("iPhone X Landscape (812px x 375px)","812px",{height:"375px"})}),extrasEditor.createNoEditAreaEditor(),extrasEditor.createAreas(),$(document).ready(function(){$(".gjs-pn-buttons > .gjs-pn-btn").click(function(){var e=$(".gjs-layer");if(e.length>0)for(var t=0;t<e.length;t++)"Keppler-style\n1"===e[t].outerText&&$(e[t]).remove()})});